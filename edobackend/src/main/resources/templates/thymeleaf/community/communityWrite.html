<!DOCTYPE html>
<html lang="ko">
<head>
    <title>커뮤니티</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8"/>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link th:rel="stylesheet" th:href="@{/assets/dropzonejs/dropzone.css}" />
    <link th:rel="stylesheet" th:href="@{/assets/toastr/toastr.min.css}" />
    <link rel="stylesheet" href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css" type="text/css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"/>
    <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>
    <link rel="stylesheet" type="text/css"
          href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.ckeditor.com/ckeditor5/35.1.0/classic/ckeditor.js"></script>


    <link rel="stylesheet" type="text/css" href="css/footer.css">
    <link rel="stylesheet" type="text/css" href="css/header.css">
    <link rel="stylesheet" type="text/css" href="css/community.css">

    <script>
        async function load() {
            let say = await import('https://unpkg.com/dropzone@5/dist/min/dropzone.min.js');
            say.dragend();
            say.click();
            say.dragenter();
            say.dragover();
            say.dragstart();
            say.drop();
            say.focus();
        }
    </script>
    <script>
        if (top != window) {
            top.location = window.location;
        }
    </script>

</head>
<body class="vsc-initialized">

<div id="wraaper">
    <!--    header   -->
    <div th:replace="/fragments/header.html :: fragment-nav"></div>

    <!--  community field  -->
    <div id="container">
        <div style="display:block;">
            <label>제목</label>
            <input type="text" name="communityTitle" id="communityTitle"></div>
<!--        파일 업로드 부분 -->
<!--        <div style="display: block">-->
<!--            <label>파일 업로드</label>-->
<!--            <form action="/upload" method="post" class="dropzone"-->
<!--                  enctype="multipart/form-data" >-->
<!--                <div id="fileDropzone">-->
<!--                    <div class="dz-message needsclick">-->
<!--                        Dropfiles here or click to upload.-->
<!--                    </div>-->
<!--                </div>-->
<!--            </form>-->
<!--            <div class="form-group">-->
                <label class="form-label mt-4"> 내용 </label>
                <div id="editor1"></div>
            </div>
            <div align="center" style= "margin-top: 10px">   <button class="btn btn-secondary" id="nextButton">등록</button></div>

    </div>
    </div>
    <!--footer-->
    <div th:replace="/fragments/footer.html"></div>

</div>
<!--<script>-->
<!--    let editor =[];-->
<!--    ClassicEditor-->
<!--        .create( document.querySelector( '#editor1' ) )-->
<!--        .then( newEditor => {-->
<!--            editor[1] = newEditor;-->
<!--        } )-->
<!--        .catch( error => {-->
<!--            console.error( error );-->
<!--        } );-->
<!--</script>-->
<!--CK Editor 사용-->
<script>
    let editor;
    ClassicEditor
        .create( document.querySelector( '#editor1' ) )
        .then( newEditor => {
            editor = newEditor;
        } )
        .catch( error => {
            console.error( error );
        } );
</script>
<script>
    // Dropzone.autoDiscover = false;
    //
    // $("#demo-upload").dropzone({
    //     success : function(file, response) {
    //         toastr.success('File ' + file.name + ' uploaded successfully');
    //     }
    // });
    // let myDropzone = new Dropzone("div#fileDropzone",{
    //     autoProcessQueue: false,
    //     maxFiles: 20,
    //     parallelUploads: 20,
    //     uploadMultiple: true,
    // })

    // $(document).on("click",'#nextButton',function() {
    //     alert('작동확인');
    //     var communityTitle = $("#communityTitle").val();
    //     var communityDetail =[];
    //     for (var i =1; i<=10; i++){
    //         communityDetail.push(editor[i].getData());}
    //     var param = {
    //         "communityTitle": communityTitle,
    //         "communityDetail": communityDetail
    //     }
    //     console.log(param);
    //
    //     $.ajax({
    //         anyne: true,
    //         type: 'POST',
    //         contentType : 'application/json',
    //         data: JSON.stringify(param),
    //         url: "/communitywirte",
    //         dataType: "text",
    //         success: function (data) {
    //             alert('성공');
    //             myDropzone.processQueue();
    //         },
    //         error: function (jqXHR, textStatus, errorThrown) {
    //             alert("ERROR : " + textStatus + " : " + errorThrown);
    //         }
    //     });
    // })
    $(document).on("click",'#nextButton',function(){
        let communityTitle = $("#communityTitle").val();
        let communityDetail = editor.getData()
        let param = {
            "communityTitle" :communityTitle,
            "communityDetail" : communityDetail
        }

        console.log(param)
    });
</script>

</body>

</html>