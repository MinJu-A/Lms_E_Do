<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layouts/headAndFootLayout}">
<head>
    <link rel="stylesheet" type="text/css" href="/css/lectureDetail.css">
    <link rel="stylesheet" type="text/css" href="/css/btnDesign.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css">
    <meta charset="utf-8">
</head>
<body>
<div layout:fragment="content">
    <div th:if="${not #strings.isEmpty(lecture)}">
        <div class="row ">
            <div class="col-sm-3 top-box-img" style="margin-left: 100px;">
                <img th:src="'/image/'+${lecture.getLectureImage()}" class="div_inner" alt="/img/project-1.jpg"/>
            </div>
            <div class="col top-box-info">
                <a class="btn blue mini" th:text="${lecture.getLecturePart()}"/>
                <h4 th:text="${lecture.getLectureTitle()}"></h4>
                <br>
                <span th:text="${lecture.getLectureDetail()}"></span>
                <br>
                <b class="top-box-teacher">아무개</b>
                <div class="top-box-bottom">
                    <a id="btnTest"><i class="bi bi-suit-heart" id="test"></i></a>
                    <span>(6.3k)</span>
                    |
                    <a class="btn red mini">구독</a>
                </div>
            </div>
        </div>
        <hr>
        <div class="row margin-top " style="width: 70%; margin: auto;">
            <div class="col-sm-12 block-contain">
                <div class="row">
                    <div class="col-sm-10 col-md-10">
                        <div class="row">
                            <div class="row">
                                <h2>강의 소개</h2>
                                <div class="form-group">
                                    <div id="lectureInfo">
                                        <dd th:utext="${lecture.getLectureInfo()}"></dd>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-sm-3 top-box-img" style="margin-left: 100px;">
                                <img src="/image/teacherImg.png" alt="/img/project-1.jpg"/>
                            </div>
                            <div class="col top-box-info">
                                <h4>아무개</h4>
                                <br>
                                <span>강사 소개</span>
                                <br>
                                <ol>
                                    <li>스펙1</li>
                                    <li>스펙2</li>
                                    <li>스펙3</li>
                                    <li>스펙4</li>
                                    <li>스펙5</li>
                                </ol>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div th:if="${not #strings.isEmpty(lectureDivide)}">
                                <p style="font-weight: 2000; font-size: 20px;">목차</p>
                                <div th:each="vo,status : ${lectureDivide}">
                                    <div class="accordion" id="accordionPanelsStayOpenExample">
                                        <div class="accordion-item">
                                            <h2 class="accordion-header"
                                                th:id="'panelsStayOpen-heading'+${status.count}">
                                                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                                        th:data-bs-target="'#panelsStayOpen-collapse'+${status.count}"
                                                        aria-expanded="true"
                                                        th:aria-controls="'panelsStayOpen-collapse'+${status.count}"
                                                        th:text="'강의'+${status.count}">
                                                </button>
                                            </h2>
                                            <div th:id="'panelsStayOpen-collapse'+${status.count}"
                                                 class="accordion-collapse collapse"
                                                 th:aria-labelledby="'panelsStayOpen-heading'+${status.count}">
                                                <div class="accordion-body">
                                                    <p style="font-weight: 1000;">강의 제목</p>
                                                    <p th:text="${vo.getLectureDivideTitle()}"></p>
                                                    <br>
                                                    <p style="font-weight: 1000;">강의 설명</p>
                                                    <dd th:utext="${vo.getLectureDivideInfo()}"></dd>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-2 col-md-2">
                        <div th:if="${lectureDivide.size()>0}">
                            <div class="side-box" id="scroll">
                                <div class="row">
                                    <a th:href="'/lecture/contents/'+${lecture.getId()}+'/'+${lectureDivide.get(0).getId()}"
                                       class="listenLecture">강의듣기</a>
                                </div>
                                <div class="row">
                                    <a class="button" th:href="'/lecture/All'">목록</a>
                                </div>
                                <div class="row">
                                <div class="col" sec:authorize="isAuthenticated()">
                                    <a class="button">강의 관리</a>
                                </div>
                                <div class="col" sec:authorize="isAuthenticated()">
                                    <a th:href="'/lecture/contents/'+${lecture.getId()}+'/'+${lectureDivide.get(0).getId()}"
                                       class="deleteLecture">강의삭제</a>
                                </div>
                                </div>
                                    <hr>
                                <div class="row">
                                    <div class="cd-floating__sub-buttons">

                                        <span class="cd-floating__sub-button like-button e-like " data-cnt="6312"
                                              data-target="PC" style="padding-right: 50px;">
                                             <span class="infd-icon"><svg width="16" height="16" viewBox="0 0 16 16"
                                                                          xmlns="http://www.w3.org/2000/svg"><path
                                                     fill="#212529" fill-rule="evenodd" clip-rule="evenodd"
                                                     d="M4.49095 2.66666C3.10493 2.66666 1.66663 3.92028 1.66663 5.67567C1.66663 7.74725 3.21569 9.64919 4.90742 11.0894C5.73796 11.7965 6.571 12.3653 7.19759 12.7576C7.51037 12.9534 7.7704 13.1045 7.95123 13.2061C7.96818 13.2156 7.98443 13.2247 7.99996 13.2333C8.01549 13.2247 8.03174 13.2156 8.04869 13.2061C8.22952 13.1045 8.48955 12.9534 8.80233 12.7576C9.42892 12.3653 10.262 11.7965 11.0925 11.0894C12.7842 9.64919 14.3333 7.74725 14.3333 5.67567C14.3333 3.92028 12.895 2.66666 11.509 2.66666C10.1054 2.66666 8.9751 3.59266 8.4743 5.09505C8.40624 5.29922 8.21518 5.43693 7.99996 5.43693C7.78474 5.43693 7.59368 5.29922 7.52562 5.09505C7.02482 3.59266 5.89453 2.66666 4.49095 2.66666ZM7.99996 13.8018L8.22836 14.2466C8.08499 14.3202 7.91493 14.3202 7.77156 14.2466L7.99996 13.8018ZM0.666626 5.67567C0.666626 3.368 2.55265 1.66666 4.49095 1.66666C6.01983 1.66666 7.25381 2.48414 7.99996 3.73655C8.74611 2.48414 9.98009 1.66666 11.509 1.66666C13.4473 1.66666 15.3333 3.368 15.3333 5.67567C15.3333 8.22121 13.4657 10.3823 11.7407 11.8509C10.863 12.5982 9.98767 13.1953 9.33301 13.6052C9.00516 13.8104 8.73133 13.9696 8.53847 14.0779C8.44201 14.1321 8.36571 14.1737 8.31292 14.2019C8.28653 14.2161 8.26601 14.2269 8.25177 14.2344L8.2352 14.2431L8.23054 14.2455L8.22914 14.2462C8.22897 14.2463 8.22836 14.2466 7.99996 13.8018C7.77156 14.2466 7.77173 14.2467 7.77156 14.2466L7.76938 14.2455L7.76472 14.2431L7.74815 14.2344C7.73391 14.2269 7.71339 14.2161 7.687 14.2019C7.63421 14.1737 7.55791 14.1321 7.46145 14.0779C7.26858 13.9696 6.99476 13.8104 6.66691 13.6052C6.01225 13.1953 5.13695 12.5982 4.25917 11.8509C2.53423 10.3823 0.666626 8.22121 0.666626 5.67567Z"></path></svg></span>
                                               <span class="cd-floating__sub-button--cnt">6.3K</span>
                                              </span>
                                        <span class="cd-floating__sub-button e-share">
                                                    <span class="infd-icon"><svg width="16" height="16"
                                                                                 viewBox="0 0 16 16"
                                                                                 xmlns="http://www.w3.org/2000/svg"><path
                                                            fill="#212529" fill-rule="evenodd" clip-rule="evenodd"
                                                            d="M13.3334 3.66666C13.3334 4.95533 12.2887 6 11 6C10.3257 6 9.7181 5.7139 9.29211 5.25646L5.88379 7.27067C5.95923 7.50012 6.00004 7.74529 6.00004 8C6.00004 8.25469 5.95923 8.49986 5.8838 8.72932L9.29224 10.7434C9.71822 10.286 10.3257 10 11 10C12.2887 10 13.3334 11.0447 13.3334 12.3333C13.3334 13.622 12.2887 14.6667 11 14.6667C9.71138 14.6667 8.66671 13.622 8.66671 12.3333C8.66671 12.0786 8.70752 11.8335 8.78296 11.604L5.37452 9.58992C4.94854 10.0473 4.34103 10.3333 3.66671 10.3333C2.37804 10.3333 1.33337 9.28866 1.33337 8C1.33337 6.71133 2.37804 5.66666 3.66671 5.66666C4.34102 5.66666 4.94853 5.9527 5.37452 6.41007L8.78295 4.39599L8.78321 4.39678C8.70761 4.1671 8.66671 3.92166 8.66671 3.66666C8.66671 2.378 9.71138 1.33333 11 1.33333C12.2887 1.33333 13.3334 2.378 13.3334 3.66666ZM12.3334 3.66666C12.3334 4.40304 11.7364 4.99999 11 4.99999C10.2637 4.99999 9.66671 4.40304 9.66671 3.66666C9.66671 2.93028 10.2637 2.33333 11 2.33333C11.7364 2.33333 12.3334 2.93028 12.3334 3.66666ZM3.66671 9.33333C4.40309 9.33333 5.00004 8.73637 5.00004 8C5.00004 7.26362 4.40309 6.66666 3.66671 6.66666C2.93033 6.66666 2.33337 7.26362 2.33337 8C2.33337 8.73637 2.93033 9.33333 3.66671 9.33333ZM12.3334 12.3333C12.3334 13.0697 11.7364 13.6667 11 13.6667C10.2637 13.6667 9.66671 13.0697 9.66671 12.3333C9.66671 11.5969 10.2637 11 11 11C11.7364 11 12.3334 11.5969 12.3334 12.3333Z"></path></svg></span>
                                                    공유
                                                  </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(window).scroll(function () {
            var position = $(document).scrollTop();
            $("#scroll").css('top', position);
        });
    </script>
    <script type="text/javascript">
        $("#uploadLecture").submit(function (event) {
            event.preventDefault();
            $("#lectureInfoHidden").val(editor[0].getData());
            this.submit();
        });
    </script>
    <script>

        ClassicEditor
            .create(document.querySelector('#lectureInfo'))
            .catch(error => {
                console.error(error);
            });
    </script>
    <!--heart 버튼 클릭 시 온 오프 및 데이터 저장-->

    <script type="text/javascript">
        //ready(function)을 통해 시작 시  heart 값이 1이면 좋아요가 눌러진 상태, 0이면 좋아요가 안 눌러진 상태
        $(document).ready(function () {
            var heart = document.getElementById('heart').value;
            var type = document.getElementById('test').className;
            if (heart == 1) {
                document.getElementById('test').className = 'bi bi-suit-heart-fill';

            } else {
                document.getElementById('test').className = 'bi bi-suit-heart';

            }

        });

        //하트 버튼 클릭 시
        $('#btnTest').on('click', function (e) {
            var type = document.getElementById('test').className;
            var id = document.getElementById('id').value;
            //좋아요가 눌러진 상태에서 한 번 더 누른다면
            if (type == 'bi bi-suit-heart-fill') {
                var heart = 0;
                //className을 bi bi-suit-heart로 변경 해 좋아요가 안눌러진 그림으로
                document.getElementById('test').className = 'bi bi-suit-heart';
                //ajax 처리를 통해 communityController의 comheart 호출(좋아요 상태를 db에 전달)
                $.ajax({
                    url: "/community/comheart",
                    type: "post",
                    data: {
                        id: id,
                        heart: heart,
                    }
                })
            } else {
                var heart = 1;
                document.getElementById('test').className = 'bi bi-suit-heart-fill';
                $.ajax({
                    url: "/community/comheart",
                    type: "post",
                    data: {
                        id: id,
                        heart: heart,
                    }
                })
            }
        });
    </script>
</div>

</body>

</html>